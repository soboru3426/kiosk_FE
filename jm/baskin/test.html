<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>배스킨라빈스</title>
    <link rel="stylesheet" href="common.css">
    <script src="script.js" defer></script>
</head>
<body>
    <div class="container">
        <!-- 헤더 동적 삽입 -->
        <div id="header-container"></div>

        <main class="content">
            <nav class="nav">
                <button class="ice-btn">아이스크림</button>
                <a href="#coffee.html">커피</a>
                <a href="#drink.html">음료</a>
                <a href="#mocchi.html">아이스모찌</a>
            </nav>

            <!-- 상품 목록 -->
            <section class="product-list">
                <div class="product">
                    <img src="./single1.png" alt="싱글레귤러">
                    <p>싱글레귤러</p>
                    <p class="price">₩3,200</p>
                </div>
                <div class="product">
                    <img src="./single2.png" alt="싱글킹">
                    <p>싱글킹</p>
                    <p class="price">₩4,000</p>
                </div>
                <div class="product">
                    <img src="./double1.png" alt="더블주니어">
                    <p>더블주니어</p>
                    <p class="price">₩4,300</p>
                </div>
                <div class="product">
                    <img src="./double2.png" alt="더블레귤러">
                    <p>더블레귤러</p>
                    <p class="price">₩6,200</p>
                </div>
                <div class="product">
                    <img src="./pint.png" alt="파인트">
                    <p>파인트</p>
                    <p class="price">₩8,200</p>
                </div>
                <div class="product">
                    <img src="./quarter.png" alt="쿼터">
                    <p>쿼터</p>
                    <p class="price">₩15,500</p>
                </div>
                <div class="product">
                    <img src="./family.png" alt="패밀리">
                    <p>패밀리</p>
                    <p class="price">₩22,000</p>
                </div>
                <div class="product">
                    <img src="./half.png" alt="하프갤런">
                    <p>하프갤런</p>
                    <p class="price">₩26,500</p>
                </div>
            </section>
        </main>

        <!-- 푸터 동적 삽입 -->
        <div id="footer-container"></div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          // Retrieve the cartOrders array from localStorage
          let storedOrders = localStorage.getItem("cartOrders");
          let cartOrders = [];
        
          if (storedOrders) {
            try {
              cartOrders = JSON.parse(storedOrders);
            } catch (e) {
              console.error("Error parsing cartOrders:", e);
            }
          }
        
          // Calculate total quantity and total price
          let totalQty = cartOrders.length; // Total number of orders
          let totalPriceSum = cartOrders.reduce((sum, order) => sum + (order.price || 0), 0); // Sum of all prices
        
          console.log("Total Orders:", totalQty, "Total Price:", totalPriceSum);
        
          // 1. Update the cart badge with the total number of orders
          const cartEl = document.querySelector('.cart');
          if (cartEl) {
            let badge = cartEl.querySelector('.cart-badge');
            if (!badge) {
              badge = document.createElement("span");
              badge.className = "cart-badge";
              cartEl.appendChild(badge);
            }
            badge.textContent = totalQty; // Display total number of orders
            badge.style.display = totalQty > 0 ? "block" : "none"; // 0이면 안보이도록 처리
          }
        
          // 2. Update the total price next to the "결제하기" button
          const payBtn = document.querySelector('.pay-btn');
          if (payBtn) {
            let priceIndicator = document.querySelector('.total-price-indicator');
            if (!priceIndicator) {
              priceIndicator = document.createElement("div");
              priceIndicator.className = "total-price-indicator";
              payBtn.parentNode.insertBefore(priceIndicator, payBtn);
            }
            priceIndicator.textContent = "₩" + Number(totalPriceSum).toLocaleString('ko-KR'); // Display total price
          }
        });
        </script>
        
        
</body>
</html>
