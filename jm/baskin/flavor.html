<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>플레이버 선택</title>
  <link rel="stylesheet" href="common.css">
  <script src="script.js" defer></script>
  <!-- 인라인 스타일 (최종 CSS) -->
  <style>
    .container {
      max-width: 1200px;
      margin: 30px auto;
      background: #fff;
      padding: 20px 40px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      border-radius: 10px;
    }
    header.header {
      text-align: center;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    header.header h2 {
      font-size: 28px;
      color: #333;
      margin: 0;
    }
    .tab-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    .tab-buttons button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-bottom: 2px solid transparent;
      background: none;
      cursor: pointer;
      transition: border-bottom 0.3s, color 0.3s;
    }
    .tab-buttons button:hover {
      color: #ff1493;
    }
    .tab-buttons button.active {
      border-bottom: 2px solid #ff1493;
      font-weight: bold;
      color: #ff1493;
    }
    .tab-content {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    .tab-content.active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .product-info {
      text-align: center;
      margin-bottom: 30px;
    }
    #product-img {
      width: 70px;
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .product-my {
      display: flex;
      gap: 50px;
      justify-content: center;
      align-items: center;
    }
    #product-price {
      margin-left: 300px;
      font-size: 30px;
      color: #ff1493;
    }
    .product-info h3 {
      font-size: 22px;
      margin: 10px 0 5px;
      color: #333;
    }
    .product-info p {
      font-size: 16px;
      color: #666;
      margin: 5px 0;
    }
    .selection {
      margin-top: 15px;
    }
    .selection .option {
      background: #f2f2f2;
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 8px 15px;
      margin: 0 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .selection .option:hover {
      background: #fffbf9;
    }
    /* 플레이버 섹션 */
    #flavorTab {
      background: #fafafa;
      padding: 20px;
    }
    /* 플레이버 패널들을 감싸는 컨테이너 */
    .flavor-panels {
      position: relative;
      height: 500px;  /* 플레이버 그리드 높이에 맞게 고정 */
      margin-bottom: 20px;
    }
    .flavor-panel {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      display: none;
    }
    .flavor-panel.active {
      display: block;
    }
    .flavor-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .flavor-grid img {
      max-width: 150px;
      width: 100%;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border 0.3s, transform 0.3s;
    }
    .flavor-grid img:hover {
      transform: scale(1.05);
    }
    .flavor-grid img.selected {
      border: 2px solid #ff1493;
    }
    /* 페이지네이션: 플레이버 그리드 아래에 위치 */
    .pagination {
      text-align: center;
      margin-top: 20px;
    }
    .pagination button {
      padding: 8px 12px;
      margin: 0 5px;
      cursor: pointer;
      border: none;
      background: #f2f2f2;
      border-radius: 5px;
      transition: background 0.3s;
    }
    .pagination button:hover {
      background: #e0e0e0;
    }
    /* 하단 영역: 수량/가격 및 내비게이션 버튼 */
    .bottom-actions {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 300px;
      gap: 15px;
    }
    .quantity-price {
      display: flex;
      align-items: center;
      gap: 20px;
      font-size: 18px;
      color: #333;
    }
    .quantity-price button {
      padding: 8px 12px;
      font-size: 18px;
      border: none;
      background: #ff1493;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .quantity-price button:hover {
      background: #ff007f;
    }
    .navigation-buttons {
      display: flex;
      gap: 20px;
    }
    .navigation-buttons button.btn {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #ff1493;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    .navigation-buttons button.btn:hover {
      background-color: #ff007f;
    }
    .btn-back {
      background-color: white;
      padding: 10px;
      font-size: 20px;
      color: #ff1493;
      border-radius: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 200px;
      height: 60px;
      margin-left: 150px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    .btn-back:hover {
      color: #ff007f;
      background-color: rgb(235, 232, 232);
    }
    .btn-cart {
      background-color: #ff1493;
      color: white;
      font-size: 18px;
      width: 200px;
      height: 60px;
      padding: 10px;
      border-radius: 60px;
      margin-right: 150px;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .btn-cart:hover {
      background-color: #ff007f;
    }
  </style>
</head>
<body>  
  <div class="container">
    <header class="header">
      <div class="tab-buttons">
        <button id="tabProduct" class="active" onclick="showTab('productTab')">상품 정보</button>
        <button id="tabFlavor" onclick="showTab('flavorTab')">플레이버</button>
      </div>
    </header>

    <!-- 상품 정보 탭 -->
    <div id="productTab" class="tab-content active">
      <div class="product-info">
        <div class="product-my">
          <img id="product-img" src="./pd_cup.png" alt="상품 이미지">
          <h3 id="product-name">상품명</h3>
          <p id="product-price">₩3200</p>
        </div>
        <p>원하는 맛을 자유롭게 선택하세요!</p>
        <div class="selection">
          <button class="option" onclick="selectOption('cup')">컵</button>
          <button class="option" onclick="selectOption('cone')">콘</button>
          <button class="option" onclick="selectOption('waffle')">와플콘</button>
        </div>
      </div>
    </div>
    
    <!-- 플레이버 탭 -->
    <div id="flavorTab" class="tab-content">
      <div class="flavor-panels">
        <div class="flavor-panel active" id="flavorPanel1">
          <h3>플레이버 1페이지</h3>
          <div class="flavor-grid">
            <img src="./flavor1.png" alt="맛 1" onclick="selectFlavor(this)">
            <img src="./flavor2.png" alt="맛 2" onclick="selectFlavor(this)">
            <img src="./flavor3.png" alt="맛 3" onclick="selectFlavor(this)">
            <img src="./flavor4.png" alt="맛 4" onclick="selectFlavor(this)">
            <img src="./flavor5.png" alt="맛 5" onclick="selectFlavor(this)">
            <img src="./flavor6.png" alt="맛 6" onclick="selectFlavor(this)">
            <img src="./flavor7.png" alt="맛 7" onclick="selectFlavor(this)">
            <img src="./flavor8.png" alt="맛 8" onclick="selectFlavor(this)">
            <img src="./flavor9.png" alt="맛 9" onclick="selectFlavor(this)">
            <img src="./flavor10.png" alt="맛 10" onclick="selectFlavor(this)">
            <img src="./flavor11.png" alt="맛 11" onclick="selectFlavor(this)">
            <img src="./flavor12.png" alt="맛 12" onclick="selectFlavor(this)">
          </div>
        </div>
        <div class="flavor-panel" id="flavorPanel2">
          <h3>플레이버 2페이지</h3>
          <div class="flavor-grid">
            <img src="./flavor13.png" alt="맛 13" onclick="selectFlavor(this)">
            <img src="./flavor14.png" alt="맛 14" onclick="selectFlavor(this)">
            <img src="./flavor15.png" alt="맛 15" onclick="selectFlavor(this)">
            <img src="./flavor16.png" alt="맛 16" onclick="selectFlavor(this)">
            <img src="./flavor17.png" alt="맛 17" onclick="selectFlavor(this)">
            <img src="./flavor18.png" alt="맛 18" onclick="selectFlavor(this)">
            <img src="./flavor19.png" alt="맛 19" onclick="selectFlavor(this)">
            <img src="./flavor20.png" alt="맛 20" onclick="selectFlavor(this)">
            <img src="./flavor21.png" alt="맛 21" onclick="selectFlavor(this)">
            <img src="./flavor22.png" alt="맛 22" onclick="selectFlavor(this)">
            <img src="./flavor23.png" alt="맛 23" onclick="selectFlavor(this)">
            <img src="./flavor24.png" alt="맛 24" onclick="selectFlavor(this)">
          </div>
        </div>
      </div>
      <div class="pagination">
        <button onclick="showFlavorPanel(1)">1</button>
        <button onclick="showFlavorPanel(2)">2</button>
      </div>
    </div>

    <!-- 하단 영역 -->
    <div class="bottom-actions">
      <div class="quantity-price">
        <button onclick="changeQuantity(-1)">-</button>
        <span id="finalQuantity">1</span>
        <button onclick="changeQuantity(1)">+</button>
        <p style="margin: 0;">합계 가격: ₩<span id="totalPrice">3200</span></p>
      </div>
      <div class="navigation-buttons">
        <button onclick="saveOrderData()" class="btn-back">이전</button>
        <button onclick="saveOrderData()" class="btn-cart">담기</button>
      </div>
    </div>
  </div>

  <!-- 스크립트 영역 -->
  <script>
    // 전역 객체: 선택된 옵션, 수량, 맛, 단가
    var orderData = {
      optionType: null,
      quantity: 1,
      flavor: null,
      price: 3200
    };

    document.addEventListener("DOMContentLoaded", function () {
      // 헤더 동적 삽입
      fetch("header.html")
        .then(response => response.text())
        .then(data => {
          const headerContainer = document.getElementById("header-container");
          if (headerContainer) {
            headerContainer.innerHTML = data;
          }
        });
    
      // 닫기 버튼 동작 (필요한 경우)
      document.addEventListener("click", function (event) {
        if (event.target.classList.contains("close-btn")) {
          window.location.href = "index.html";
        }
      });

      // URL 파라미터에서 상품명, 가격 저장
      const params = new URLSearchParams(window.location.search);
      const name = params.get("name");
      const price = params.get("price");
      if (name) {
        document.getElementById("product-name").textContent = name;
      }
      if (price) {
        const parsedPrice = parseInt(price, 10);
        document.getElementById("product-price").textContent = `₩${parsedPrice.toLocaleString('ko-KR')}`;
        orderData.price = parsedPrice;
        document.getElementById("totalPrice").textContent = parsedPrice.toLocaleString('ko-KR');
      }
    });
    
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(function(tab) {
        tab.classList.remove('active');
      });
      document.getElementById(tabId).classList.add('active');
      document.getElementById("tabProduct").classList.toggle("active", tabId === "productTab");
      document.getElementById("tabFlavor").classList.toggle("active", tabId === "flavorTab");
    }
    
    function showFlavorPanel(page) {
      document.querySelectorAll('.flavor-panel').forEach(function(panel) {
        panel.classList.remove('active');
      });
      const targetPanel = document.getElementById('flavorPanel' + page);
      if (targetPanel) {
        targetPanel.classList.add('active');
      } else {
        console.error('flavorPanel' + page + ' 요소를 찾을 수 없습니다.');
      }
    }
    
    function selectFlavor(imgElement) {
      const panel = imgElement.parentNode;
      panel.querySelectorAll('img').forEach(function(img) {
        img.classList.remove('selected');
      });
      imgElement.classList.add('selected');
      // 선택된 맛을 orderData에 저장 (여기서는 alt 속성을 flavor 이름으로 활용)
      orderData.flavor = imgElement.alt;
      console.log("선택된 맛:", orderData.flavor);
    }
    
    function selectOption(option) {
      console.log("선택된 옵션:", option);
      orderData.optionType = option;
    }
    
    function changeQuantity(delta) {
      let finalQtyElem = document.getElementById("finalQuantity");
      let current = parseInt(finalQtyElem.textContent, 10);
      current = Math.max(1, current + delta);
      finalQtyElem.textContent = current;
      orderData.quantity = current;
      document.getElementById("totalPrice").textContent = (current * orderData.price).toLocaleString('ko-KR');
    }
    
    // 저장된 데이터들을 로컬 스토리지에 저장하고 다음 페이지로 이동하는 예제 함수
    function saveOrderData() {
      console.log("최종 주문 데이터:", orderData);
      // 예시: 로컬 스토리지에 저장 (나중에 다른 페이지에서 활용)
      localStorage.setItem("orderData", JSON.stringify(orderData));
      // 예시: 다음 페이지로 이동
      // window.location.href = "nextpage.html";
      alert("주문 데이터가 저장되었습니다. 다음 페이지에서 활용하세요!");
    }
  </script>
</body>
</html>
